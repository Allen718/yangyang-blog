![](https://user-gold-cdn.xitu.io/2020/7/22/173747c890b5ef64?w=345&h=559&f=png&s=19610)
## 进入记账页面，
根据设计图，开始着手写第一个页面，一般规律是先写html 再写css 最后写js .
- html 根据页面，大概分为四个板块，然后每个板块再细分。书写html时，我们需要做一些全局的样式设置，比如pading margin 盒模型 ul,ol默认样式，全局的字体大小等设置，'fonts.css'是一个中文字体库，它可以做到让我们设计的应用的字体在各类型的移动端无论时中文或英文都看起来比较正常。
###  书写css,
- 书写css遵循的原则即使尽量不要写固定的宽高，实现效果的方式多种多样，只要能够正常运行就可以，在使用float 布局的时候父元素需要加上几句代码
```
clearfix::after{
    content:'';
    display:block;
    clear:both;
}
```
如果用到这个的地方比较多，可以考虑做成变量，
```
%clearFix{&::afer{
    content:'';
    display:block;
    clear:both;  
}}
```
然后只需要在使用时引入并使用`@extend %clearFix`。
- 模块化思想，在这个记账组件还没有写js的情况下，由于写css和html就已经快接近两百行了，将里面的各个模块抽离出来，变成四个独立的组件，每个组件负责自己的html css 以及相应的js.
### 各模块js的书写
由于ts比js 更加严谨，他会在编译代码时，检查代码是否有错，删掉类型编译为js
- 关于vue组件的几种写法
ts写法
```
<script lang="ts">//也可以改lang='js'，就变成js写法
  import Vue from 'vue';
  import {Component} from 'vue-property-decorator';

  @Component
  export default class NumberPad extends Vue {
        }
```
传统写法
```
<script lang="js">
  
  export default  {//里面写data props methods created等
        }

```
关于在组件里面使用props，使用官方推荐方式失败，然后在`vue-property-decorate`的使用方法是`@prop()xxx:`

- 顶部支出与收入类型选择模块，添加一个事件监听，当点击支出或者收入时，设置一个动态的类名，`:class="type==='-'&&'selected'"`给这个类名添加一些样式，设计稿给的是加粗，使用下边框加粗时，发现字体在垂直方向不居中，后改用
```
&.selected::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: #333;
      }
```
- 标签选择组件
这一个板块主要有两个功能需要实现，一个是当点击新增标签按钮时，完成标签的新增，另一个功能就是当我们记账的时候需要点击这些标签按钮，完成一次对记账的描述。
```
 toggle(tag: string) {
      const index = this.selectedTags.indexOf(tag);
      if (index >= 0) {
        this.selectedTags.splice(index, 1);
      } else {
        this.selectedTags.push(tag);
      }
    }
    create() {
      const name = window.prompt('请输入标签名');
      if (name === '') {
        window.alert('标签名不能为空');
      } else if (this.dataSource) {
        this.$emit('update:dataSource',
          [...this.dataSource, name]);
      }
    }
```
关于`datasource`为外部数据，由外部传入，子组件对这些数据只读不修改，当要改变也是通知外部修改。

- 关于备注组件
备注组件涉及到v-model，vue的数据双向绑定原理，具体可以看我写的另一篇博客。
- 数字面板组件
一般会使用等宽字体，monospace.显示的应该一串字符串，并不是数字，因为数字不会显示出'0.' ,做数字面板需要考虑的点大概就字符串的长度是要有一定的限度，不能有多个点，也不能出现以点开头等。小知识点`if(input==='0'|'1'|'2'|'4')`可以简写成`if ('012345'.indexof(input)>=0)`
###  收集各个子组件的数据
当记一笔帐的时候我们需要将此时的数据收集起来做成历史数据，以供后期使用，所以这四个子组件需要收集的数据，最好是外部传入的，子组件只需要读取数据，其余操作都由外部的组件进行操作就可以了。
- 收集记账类型，是支出还是收入
```
@Prop() readonly value!: string;
selectType(type: string) {
      if (type !== '-' && type !== '+') {
        throw new Error('type is unknown');
      }
      this.type = type;
      this.$emit('update:value', type);
    }
    
 ```
     
   外部组件 接受到消息以后
  ```
    <Types :value="record.type"/>
    update:value(value) {
      this.record.type = value;
    }
 简写为：
  <Types :value.sync="record.type"/>
```
其他几个组件的收集方式同理，只不过每个组件的数据各不相同。关于.sync的用法
```
type Record = {
    tags: string[]
    notes: string
    type: string
    amount: number
  }
  record: Record = {
      tags: [], notes: '', type: '-', amount: 0
    };
    
```
### 保存数据
将收集到的每一次记账数据，保存到localstorage里面
- 当用户完成一次记账，点击ok键的时候，触发保存记账数据事件，然后保存到本地数据库.
- 关于数据迁移问题，刚开始的时候假如我们保存一次记账数据的时候没有想到要由一个保存时间的这一项，后面发现必须要有一个保存时间，为了弥补这些个缺陷，我们可以在刚开始的时候做个版本配置,下面是一种操作思路，具体还得以工作应用为主
```
window.localstorage.setItem('version','0.0.1')
if(version<'0.0.2'){
if(version==='0.0.1'){
recordlist.forEach(record=>{record.createAt=new Date()})}
}
```
